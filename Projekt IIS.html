<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0067)https://www.fit.vutbr.cz/study/courses/IIS/private/projekt/doc.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-2"></head>
    
    <title>Projekt IIS</title>
    <style type="text/css">
    	table { border-collapse: collapse; }
    	td, th { border: 1px solid black; padding: 0.3em 0.5em; text-align: left; }
    	dt { font-weight: bold; margin-top: 0.5em; }
    </style>

<!-- Zkontrolujte prosím nastavení kódování v hlavièce dokumentu 
     podle pou¾itého editoru -->

<h1>IoT: správa zaøízení</h1> <!-- Nahradte názvem svého zadání -->

<dl>
	<dt>Autoøi</dt>
	<dd>První jméno <!-- Nahraïte skuteèným jménem a e-mailem autora a popisem èinnosti -->
	    <a href="mailto:xkalen07@stud.fit.vutbr.cz">xkalen07@stud.fit.vutbr.cz</a> -
		u¾ivatelské rozhraní, nasazení systému, testování
	</dd>
	<dd>Druhé jméno <!-- Nahraïte skuteèným jménem a e-mailem autora a popisem èinnosti -->
	    <a href="mailto:xkubin27@stud.fit.vutbr.cz">xkubin27@stud.fit.vutbr.cz</a> -
		implementaèní prostøedí, autentizace, autorizace, testování
	</dd>
  <dd>Tøetí jméno <!-- Nahraïte skuteèným jménem a e-mailem autora a popisem èinnosti -->
	    <a href="mailto:xstrei06@stud.fit.vutbr.cz">xstrei06@stud.fit.vutbr.cz</a> -
		Modely databáze, implementace databáze, implementace prisma dotazù, testování
	</dd>
	<dt>URL aplikace</dt>
	<dd><a href="https://vut-iis.vercel.app/">https://vut-iis.vercel.app/</a></dd>
</dl>

<h2>U¾ivatelé systému pro testování</h2>
<p>Uveïte prosím existující zástupce <strong>v¹ech rolí u¾ivatelù</strong>.</p>
<table>
<tbody><tr><th>Login</th><th>Heslo</th><th>Role</th></tr>
<tr><td>admin</td><td>4Adm1n$#23</td><td>Administrátor</td></tr>
<tr><td>Pepa</td><td>Pepa123</td><td>U¾ivatel</td></tr>
<tr><td>Franta</td><td>Franta123</td><td>U¾ivatel</td></tr>
<tr><td>broker</td><td>3r0k3r</td><td>Broker</td></tr>
</tbody></table>

<h3>Video</h3>

<p>Pøilo¾te odkaz na komentované video demostrující pou¾ití informaèního systému. Zamìøte se na pøípady u¾ití definované zadáním (napø. registrace u¾ivatele, správa u¾ivatelù a èinnosti jednotlivých rolí). Video nahrajte napøíklad na VUT Google Drive, kde ho bude mo¾né pøímo spustit z odkazu.</p> 

<h2>Implementace</h2>

<h3>Technologie</h3>
	<ul>
		<li>U¾ivatelské rozhraní - Next.js (React.js)</li>
		<li>Implementaèní prostøedí - Next.js (Node.js)</li>
		<li>Autentizace - next-auth</li>
		<li>Autorizace - next-auth</li>
		<li>databáze - Postgres</li>
		<li>Hosting databáze - Supabase</li>
		<li>ORM - Prisma</li>
		<li>Hosting aplikace - Vercel</li>
		<li>Repozitáø - GitHub</li>
	</ul>

<h3>Struktura aplikace</h3>
	<ul>
		<li>app/profile - slo¾ka obsahující jednotlivé stránky aplikace</li>
		<li>app/api - slo¾ka obsahující implementaèní prostøedí</li>
		<li>components - slo¾ka obsahující komponenty aplikace</li>
		<li>prisma - slo¾ka obsahující prisma schéma pro databázi</li>
		<li>.env - soubor obsahující promìnné pro pøipojení k databázi a správné fungování next-auth</li>
		<li>package.json - soubor obsahující informace o aplikaci a jejích balíècích</li>
		<li>package-lock.json - soubor obsahující informace o aplikaci a jejích balíècích, vèetnì konkrétních verzí</li>
		<li>README.md - soubor obsahující informace o aplikaci</li>
	</ul>

<h3>Slo¾ka API</h3>
	<ul>
		<li>auth - slo¾ka s implementací vlastního poskytovatele pro autentizaci a autorizaci</li>
		<li>broker - implementace implementaèního prostøedí pro brokera</li>
		<li>profile - implementaèní prostøedí pro u¾ivatele a systémy</li>
	</ul>

<h3>Slo¾ka profile</h3>
	<ul>
		<li>page.tsx - úvodní stránka</li>
		<li>profile/[username]/page.tsx - pøehled daného u¾ivatele</li>
		<li>profile/[username]/devices/page.tsx - pøehled zaøízení</li>
		<li>profile/[username]/devices/[deviceId]/page.tsx - pøehled detailu zaøizení a jeho editace</li>
		<li>profile/[username]/devices/[deviceId]/kpi/page.tsx - tvorba nového KPI</li>
		<li>profile/[username]/devices/[deviceId]/manageKpi/page.tsx - pøehled KPIs daného zaøízení</li>
		<li>profile/[username]/devices/[deviceId]/manageKpi/[kpiId]/page.tsx - editace daného kpi</li>
		<li>profile/[username]/devices/createDevice/page.tsx - vytváøení nového zaøízení, pøípadnì nového typu a jeho parametrù</li>
		<li>profile/[username]/deviceTypes/page.tsx - pøehled typu zaøízení daného u¾ivatele</li>
		<li>profile/[username]/edit/page.tsx - stránka pro úpravu hesla u¾ivatele</li>
		<li>profile/[username]/manage/page.tsx - administrativní stránka s pøehledem u¾ivatelù</li>
		<li>profile/[username]/systems/page.tsx - pøehled systémù daného u¾ivatele</li>
		<li>profile/[username]/systems/[systemId]/page.tsx - stránka s detaily daného u¾ivatele</li>
		<li>profile/[username]/systems/[systemId]/editSystem/page.tsx - stránka pro editováni daného systému</li>
		<li>profile/[username]/systems/addSystem/page.tsx - stránka pro tvorbu nového systému</li>
		<li>profile/[username]/systems/sharedSystem/page.tsx - pøehled systémù sdílených danému u¾ivateli</li>
		<li>profile/login/page.tsx - stránka na pøihlá¹ení</li>
		<li>profile/register/page.tsx - stránka na registraci</li>
	</ul>

<h3>Databáze</h3>

<img src="IIS.png" alt="Databáze" width="600" height="600">

<h2>Instalace</h2>

<ul>
<li>Aplikace i databáze bì¾í na vzdálených serverech, respektive Vercel pro aplikaci a Supabase na Postgres databázi.</li>
<li>Ke spu¹tìní jsou potøeba následující: Node.js 18 a vy¹¹í, správce balíèkù npm nebo pnpm, ostatní po¾adované balíèky se stáhnou pøíkazem "npm install"</li>
<li>Dodateènì jsou po¾adované 4 promìnné v souboru .env, které v¹ak z bezpeènostních dùvodù nedistribuujeme</li>
<li>Se v¹emi potøebnými údaji a po¾adavky poté staèí pou¾ít pøíkazy "npx prisma generate" a poté "npm run dev" pro lokální spu¹tìní</li>
</ul>

<h2>Známé problémy</h2>
	<p>
		Broker je implementován pomocí python skriptu iis_broker.py. Pomocí tohoto skriptu se aktualizují vybrané hodnoty senzorù v systému. Pøíkladem spu¹tìní je následující pøíkaz: ( python3 iis_broker.py 85 23 22 "broker" "3r0k3r" ). Tento pøíkaz aktualizuje hodnotu pøístroje s id 85, parametrem 23 na hodnotu 22, poslední 2 hodnoty jsou u¾ivatelské jméno a heslo daného brokera. Pøi spu¹tìní skriptu je nutné mít nainstalovaný python3 a knihovnu requests. Skript je mo¾né spustit i na jiném stroji, ne¾ na kterém bì¾í aplikace.
		Tato implementace brokera je pouze demonstraèní a není urèena pro ostrý provoz.
	</p>
	<p>
		Broker v aktualním stavu vy¾aduje znalost identifikátorù parametrù a pøístrojù.
	</p>


<h2>Testování</h2>
	<p>
		Testování probìhlo v¹emi vývojáøi ruèními E2E testy.
	</p>

<h2>Rozdíly od zadání</h2>
	<p>
		<ul>
			<li>U¾ivatelé se pøidávají do systému na základì pozvánky od vlastníka systému, nikoliv na podnìt ¾ádosti o pøidání</li>
			<li>Ka¾dý u¾ivatel má vlastní typy zaøízení</li>
		</ul>
	</p>
</html>